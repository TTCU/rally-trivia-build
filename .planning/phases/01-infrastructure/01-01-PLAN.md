---
phase: 01-infrastructure
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - astro.config.mjs
  - wrangler.jsonc
  - package.json
  - src/styles/global.css
  - src/consts.ts
  - src/pages/index.astro
  - src/pages/features.astro
  - src/pages/about.astro
  - src/pages/contact.astro
autonomous: true
requirements:
  - INFR-01
  - INFR-02
  - INFR-06
  - INFR-09

must_haves:
  truths:
    - "Running `npm run build` produces a dist/ folder with static HTML files and no _worker.js directory"
    - "Tailwind v4 @theme brand tokens (navy, deep blue, electric blue, gold, coral) are defined and generate utility classes"
    - "Plus Jakarta Sans variable font is installed and configured as the default sans font"
    - "Sitemap integration is configured with the site URL set"
    - "Blog scaffold artifacts (content collections, MDX, RSS, blog pages, old fonts) are removed"
  artifacts:
    - path: "astro.config.mjs"
      provides: "Static Astro config with Tailwind v4 vite plugin and sitemap integration"
      contains: "@tailwindcss/vite"
    - path: "wrangler.jsonc"
      provides: "Cloudflare Workers static-assets-only deploy config"
      contains: "assets"
    - path: "src/styles/global.css"
      provides: "Tailwind v4 import with @theme brand tokens"
      contains: "@theme"
    - path: "src/consts.ts"
      provides: "Site constants (title, description, URL)"
    - path: "src/pages/index.astro"
      provides: "Placeholder home page"
    - path: "src/pages/features.astro"
      provides: "Placeholder features page"
    - path: "src/pages/about.astro"
      provides: "Placeholder about page"
    - path: "src/pages/contact.astro"
      provides: "Placeholder contact page"
  key_links:
    - from: "astro.config.mjs"
      to: "@tailwindcss/vite"
      via: "vite.plugins array"
      pattern: "tailwindcss\\(\\)"
    - from: "astro.config.mjs"
      to: "@astrojs/sitemap"
      via: "integrations array"
      pattern: "sitemap\\(\\)"
---

<objective>
Strip the Astro blog starter scaffold down to a clean static marketing site foundation, install Tailwind v4 with brand tokens, configure Cloudflare Workers for static-only deploy, install Fontsource font, and create placeholder pages for all routes.

Purpose: Establish the project foundation so that Plan 02 can build layout and components on a clean, working base with all dependencies installed and configured.
Output: A buildable Astro project with Tailwind v4 brand tokens, static Cloudflare Workers config, Plus Jakarta Sans font, and 4 placeholder pages.
</objective>

<execution_context>
@/Users/jslitzker/.claude/get-shit-done/workflows/execute-plan.md
@/Users/jslitzker/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/01-infrastructure/01-RESEARCH.md
@.planning/phases/01-infrastructure/01-CONTEXT.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Clean blog scaffold and install dependencies</name>
  <files>
    package.json
    src/content/blog/ (delete directory)
    src/content.config.ts (delete)
    src/pages/blog/ (delete directory)
    src/pages/rss.xml.js (delete)
    src/components/FormattedDate.astro (delete)
    public/fonts/ (delete directory if exists)
  </files>
  <action>
1. Remove blog scaffold artifacts:
   - Delete `src/content/` directory entirely (blog content collection)
   - Delete `src/content.config.ts` (blog content config)
   - Delete `src/pages/blog/` directory (blog pages)
   - Delete `src/pages/rss.xml.js` (RSS feed)
   - Delete `src/components/FormattedDate.astro` (blog date formatter)
   - Delete `public/fonts/` directory if it exists (old Atkinson font files)

2. Uninstall unused blog dependencies:
   ```bash
   npm uninstall @astrojs/cloudflare @astrojs/mdx @astrojs/rss
   ```
   The `@astrojs/cloudflare` adapter MUST be removed — it generates `_worker.js` in the build output which conflicts with the static-only deploy requirement.

3. Install new dependencies:
   ```bash
   npm install tailwindcss @tailwindcss/vite motion @fontsource-variable/plus-jakarta-sans
   ```

4. Verify `package.json` no longer lists `@astrojs/cloudflare`, `@astrojs/mdx`, or `@astrojs/rss` in dependencies.
  </action>
  <verify>
    - `ls src/content/` should fail (directory removed)
    - `ls src/pages/blog/` should fail (directory removed)
    - `cat package.json | grep -c "astrojs/cloudflare"` returns 0
    - `cat package.json | grep -c "tailwindcss"` returns 1+
    - `cat package.json | grep -c "motion"` returns 1+
    - `cat package.json | grep -c "fontsource"` returns 1+
  </verify>
  <done>Blog scaffold artifacts are completely removed. Unused blog dependencies uninstalled. Tailwind v4, Motion, and Fontsource dependencies installed.</done>
</task>

<task type="auto">
  <name>Task 2: Configure Astro, Tailwind v4, Wrangler, and create placeholder pages</name>
  <files>
    astro.config.mjs
    wrangler.jsonc
    src/styles/global.css
    src/consts.ts
    src/pages/index.astro
    src/pages/features.astro
    src/pages/about.astro
    src/pages/contact.astro
  </files>
  <action>
1. Rewrite `astro.config.mjs` for static output + Tailwind v4 + sitemap:
   ```javascript
   import { defineConfig } from "astro/config";
   import sitemap from "@astrojs/sitemap";
   import tailwindcss from "@tailwindcss/vite";

   export default defineConfig({
     site: "https://rallytrivia.com",
     integrations: [sitemap()],
     vite: {
       plugins: [tailwindcss()],
     },
   });
   ```
   CRITICAL: No adapter import, no `output` field (static is default in Astro 5).

2. Rewrite `wrangler.jsonc` (rename from wrangler.json if needed) for static-assets-only:
   ```jsonc
   {
     "name": "rally-trivia-web",
     "compatibility_date": "2025-10-08",
     "assets": {
       "directory": "./dist"
     }
   }
   ```
   CRITICAL: Remove `main`, `binding: "ASSETS"`, `compatibility_flags: ["nodejs_compat"]`. These are SSR artifacts.

3. Rewrite `src/styles/global.css` with Tailwind v4 and brand @theme tokens:
   ```css
   @import "tailwindcss";

   @theme {
     --color-navy: #0a1628;
     --color-deep-blue: #1a3a6b;
     --color-electric-blue: #2563eb;
     --color-gold: #f59e0b;
     --color-coral: #f97316;
     --font-sans: 'Plus Jakarta Sans Variable', system-ui, sans-serif;
     --radius-brand: 0.75rem;
   }

   body {
     font-family: var(--font-sans);
   }
   ```

4. Update `src/consts.ts` with marketing site constants:
   ```typescript
   export const SITE_TITLE = "Rally Trivia";
   export const SITE_DESCRIPTION = "Interactive trivia experiences for nonprofit fundraisers and corporate events";
   export const SITE_URL = "https://rallytrivia.com";
   ```

5. Rewrite `src/pages/index.astro` as a minimal placeholder page:
   ```astro
   ---
   import '../styles/global.css';
   ---
   <html lang="en">
     <head><meta charset="utf-8" /><title>Rally Trivia</title></head>
     <body class="bg-navy text-white font-sans">
       <h1 class="text-4xl font-bold text-electric-blue p-8">Rally Trivia</h1>
       <p class="px-8 text-gold">Coming soon — infrastructure placeholder</p>
     </body>
   </html>
   ```
   This minimal page tests that Tailwind v4 brand tokens work. It will be replaced by BaseLayout in Plan 02.

6. Create `src/pages/features.astro`, `src/pages/about.astro`, `src/pages/contact.astro` as similar minimal placeholders (different heading text for each). These ensure sitemap generates all 4 routes. They will be replaced with real content in Phase 2 and 3.

7. Delete the old `src/pages/about.astro` blog-style about page before creating the new one.

8. Run `npm run build` to verify:
   - Build succeeds with no errors
   - `dist/` contains `index.html`, `features/index.html`, `about/index.html`, `contact/index.html`
   - `dist/sitemap-index.xml` exists
   - `dist/_worker.js` does NOT exist
   - HTML files contain Tailwind-generated CSS with brand color values

9. If the wrangler.json file exists (not wrangler.jsonc), rename it to wrangler.jsonc OR rewrite wrangler.json — check which filename exists first.
  </action>
  <verify>
    - `npm run build` completes with exit code 0
    - `ls dist/index.html` succeeds
    - `ls dist/features/index.html` succeeds
    - `ls dist/about/index.html` succeeds
    - `ls dist/contact/index.html` succeeds
    - `ls dist/sitemap-index.xml` succeeds
    - `ls dist/_worker.js 2>/dev/null` returns nothing (no _worker.js)
    - `grep "0a1628" dist/index.html` confirms navy color token compiled into CSS
  </verify>
  <done>Astro builds successfully as a static site. Tailwind v4 brand tokens compile to utility classes. Sitemap generates at sitemap-index.xml. Wrangler is configured for static-assets-only deploy. Four placeholder pages exist at /, /features, /about, /contact. No _worker.js in build output.</done>
</task>

</tasks>

<verification>
1. `npm run build` exits 0 with no warnings about missing adapter
2. `dist/` contains only static HTML, CSS, JS — no `_worker.js` directory
3. `dist/sitemap-index.xml` exists and references all 4 pages
4. Brand color hex values appear in compiled CSS output
5. `package.json` has no `@astrojs/cloudflare` dependency
</verification>

<success_criteria>
- Clean Astro 5 static project with no blog artifacts
- Tailwind v4 brand tokens defined and generating utilities
- Cloudflare Workers config is static-assets-only
- Plus Jakarta Sans font installed via Fontsource
- 4 placeholder pages build successfully
- Sitemap XML generated
</success_criteria>

<output>
After completion, create `.planning/phases/01-infrastructure/01-01-SUMMARY.md`
</output>
